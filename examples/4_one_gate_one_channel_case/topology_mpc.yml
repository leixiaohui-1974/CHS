# System topology for Case 4: One Gate, One Channel (MPC version)
# Controller properties are defined in control_parameters.yaml

components:
  - name: inflow_to_channel
    type: Disturbance

  - name: channel
    type: MuskingumChannelModel
    properties:
      K: 5.0
      x: 0.1 # Corrected for stability
      dt: 1.0
      initial_inflow: 10.0
      initial_outflow: 10.0
    connections:
      inflow: inflow_to_channel.output

  - name: mpc_controller
    type: MPCController
    connections:
      measured_value: channel.output

  - name: gate
    type: GateStationModel
    properties:
      num_gates: 1
      gate_width: 1.0 # Assuming a gate width of 1m
      discharge_coeff: 0.6
    connections:
      upstream_level: channel.output
      gate_opening: mpc_controller.output

logging:
  - time
  - channel.output
  - gate.output
  - mpc_controller.output
  - inflow_to_channel.output
