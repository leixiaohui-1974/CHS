# 第十章：输水系统 (1) - 明渠 (Channel)

到目前为止，我们已经探讨了各种水力控制“点”结构（闸、泵、阀、水电站）。从本章开始，我们将进入“线”结构——用于输送水的系统，首先从明渠开始。

与之前将水库等效为一个“水桶”的一阶模型不同，模拟明渠中的水流需要更复杂的物理模型，以描述水位和流量沿渠道随时间和空间的变化。`chs-sdk` 为此提供了基于 **圣维南方程 (St. Venant Equations)** 的一维水动力学模型 `StVenantModel`。

## 核心概念：一维水动力学模型

1.  **圣维南方程**: 这是一对方程（连续性方程和动量方程），描述了明渠中非恒定流的物理过程。求解这组方程可以得到渠道中任意位置、任意时刻的水位和流量。
2.  **网络拓扑**: `StVenantModel` 将一个河道或渠系网络看作是由 **节点 (Nodes)** 和 **河段 (Reaches)** 组成的。
    *   **节点 (Node)**: 代表了河段的端点、边界条件（如上游入流、下游水位）、汇合点或分叉点。
    *   **河段 (Reach)**: 代表了两个节点之间的渠道段，具有长度、断面形状、糙率、底坡等物理属性。
3.  **数值求解**: SDK内部使用有限差分法等数值方法来求解圣维南方程，计算出每个河段在每个时间步的水位和流量剖面。

## 场景：模拟河道洪水波演进

我们将模拟一个经典的河道演算场景：
*   一条长5000米的梯形断面河道。
*   上游给定一个变化的入流过程，模拟一个洪水波（流量先增大后减小）。
*   下游给定一个固定的水位作为出口边界。
*   **目标**: 观察这个洪水波是如何沿着河道向下游传播和演进的（这个过程也称为“洪水演算”）。

## 构建仿真脚本

### 组件解释

*   `StVenantModel`: 这是我们本章的核心模型。它的初始化需要接收节点、河段和（可选的）结构物的配置信息。
*   **节点 (Nodes)**: 我们将定义两个节点：一个上游的 `inflow` 型边界节点和一个下游的 `level` 型边界节点。
*   **河段 (Reach)**: 我们将定义一个连接这两个节点的河段，并为其指定物理参数。

### 完整脚本与运行

本章的完整示例代码已保存到以下文件中：

`source/ch10/ch10_channel_simulation.py`

您可以直接运行此文件来查看仿真结果：

```bash
python water_system_sdk/docs/guide/source/ch10/ch10_channel_simulation.py
```

### 预期结果

运行脚本后，您会看到：
*   **上图** 显示了上游入流（蓝线）和下游出流（红线）的流量过程线。您会清楚地看到，下游的洪水波相比上游，不仅在时间上有所 **延迟 (Translation)**，而且洪峰流量有所 **削减 (Attenuation)**，波形变得更“胖”更“矮”。这正是河道演算的典型特征。
*   **下图** 显示了河道中点水位的变化过程，它也同样反映了洪水波的传播和演进。

本章向您介绍了如何使用 `StVenantModel` 来进行专业的一维水动力学仿真。这个模型是构建复杂河网、流域水系等大型系统的基础。
