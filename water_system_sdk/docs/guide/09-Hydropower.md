# 第九章：水力控制结构 (4) - 水电站 (Hydropower Station)

在介绍了闸、泵、阀之后，本章我们来探讨一个更复杂的、集控制与效益于一体的结构：水电站。水电站不仅是重要的泄水建筑，更是产生清洁能源、获取经济效益的关键设施。

本章将教您如何使用 `chs-sdk` 来模拟一个水电站的运行，并观察在不同工况下其流量和发电功率的变化。

## 核心概念：水电站模型

`chs-sdk` 中的 `HydropowerStationModel` 将复杂的物理过程简化为几个核心概念：

1.  **水头 (Head)**: 这是驱动水轮机发电的根本。它等于水电站的上游水位与下游水位之差。水头越高，发电潜力越大。
2.  **导叶开度 (Vane Opening)**: 这是水电站的主要控制变量，类似于阀门的开度，是一个0到1之间的值。它决定了水流通过水轮机的有效面积，从而控制流量。
3.  **流量 (Flow)**: 通过水轮机的流量 `Q` 由水头 `H` 和导叶开度 `a` 共同决定，遵循类似于孔口出流的公式：`Q = C_d * A_max * a * sqrt(2 * g * H)`。
4.  **发电功率 (Power)**: 发电功率 `P` 是水头 `H` 和流量 `Q` 的函数，公式为：`P = η * ρ * g * Q * H`。其中 `η` (eta) 是综合效率系数，`ρ` (rho) 是水的密度，`g` 是重力加速度。

## 场景：水库发电模拟

我们将模拟以下场景：
*   一个上游水库，其水位会因为发电泄流而下降。
*   一个紧邻水库的水电站。
*   水电站的下游尾水位保持恒定。
*   **目标**: 我们将手动控制水电站的导叶开度，观察不同开度对流量和发电量的影响，以及对上游水库水位的影响。

## 构建仿真脚本

### 组件解释

*   `FirstOrderStorageModel`: 用于代表我们的上游发电水库。
*   `HydropowerStationModel`: 我们的核心组件。我们将为其配置最大过流面积、效率等关键参数。
*   **控制逻辑**: 为了清晰地展示水电站模型的特性，我们将不使用控制器，而是在仿真循环中手动设置不同的导叶开度。

### 完整脚本与运行

本章的完整示例代码已保存到以下文件中：

`source/ch09/ch09_hydropower_control.py`

您可以直接运行此文件来查看仿真结果：

```bash
python water_system_sdk/docs/guide/source/ch09/ch09_hydropower_control.py
```

### 预期结果

运行脚本后，您会看到一个包含三个子图的图表：
*   **上图** 显示了上游水库的水位。随着水电站的泄流，水位会逐渐下降。
*   **中图** 显示了通过水电站的流量。您会看到流量随着导叶开度的增大而增大，但由于上游水位的下降（水头减小），在同一开度下流量会略有减小。
*   **下图** 显示了发电功率。功率曲线的趋势与流量相似，但它同时受到水头和流量的影响。当水库水位下降时，即使流量不变，功率也会减小。

本章介绍了水电站的基本建模方法。在实际应用中，水电站的调度是一个复杂的优化问题，通常需要结合电价、来水预报和下游需求，使用MPC或其它优化算法来制定最优的发电计划。
